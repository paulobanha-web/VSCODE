TimeGAN for Longitudinal Tabular Data
Validating Synthetic Data Utility in Multi-Class Health Prediction
This repository contains the source code and experimental framework for the Master's Dissertation: "Time-series GAN for Longitudinal Tabular Data: Validating Synthetic Data Utility in Multi-Class Health Prediction."

üìå Overview
This project addresses the challenge of data scarcity and class imbalance in longitudinal Electronic Health Records (EHR). Using a dataset of only 117 records, we implemented a Time-series Generative Adversarial Network (TimeGAN) to create a high-fidelity synthetic patient population (N=15,904).

The core of this research is the validation of an architectural dependency: proving that sequence-aware models (LSTM) are required to fully leverage the temporal fidelity preserved by TimeGAN, whereas static models (MLP) fail to generalize.

üöÄ Key Features
TimeGAN Implementation: Optimized for longitudinal tabular data using GRU cells.

PCA Dimensionality Reduction: Pre-processing pipeline reducing 55 clinical features to 39 components.

Rejection Sampling: Custom logic to mitigate extreme class imbalance in synthetic generation.

TSTR Framework: A rigorous "Train Synthetic, Test Real" evaluation pipeline.

Comparative Modeling: Implementation of MLP (Static) vs. LSTM (Sequential) classifiers.


üìä Experimental Results
The models were evaluated on an unseen Real Patient Test Set (T1).

Model,  Architecture,  Training Data,          Macro F1,  Weighted F1
M1,     MLP,           Real (Scarce),          15.17%,    -
M3,     MLP,           Synthetic (Balanced),   60.11%,    62.45%
M4,     LSTM,          Synthetic (Balanced),   74.10%,    74.67%

Key Finding: The LSTM (M4) outperformed the MLP (M3) by ~14%, proving the necessity of sequential modeling for TimeGAN-generated data.

üîç Statistical Validation
Fidelity was confirmed using:

Two-sample Kolmogorov-Smirnov test for marginal distributions.

(Phase 1 - Imbalanced)

<img width="276" height="292" alt="image" src="https://github.com/user-attachments/assets/ab390cd3-4530-4d8d-b66b-eb87feac9b64" />

(Phase 2  - Near Balanced)

<img width="273" height="294" alt="image" src="https://github.com/user-attachments/assets/1f98f2d9-2ff0-40ef-9f10-b4f932563d30" />


PCA & t-SNE projections for structural manifold overlap.

(Phase 1 - Imbalanced)
 
<img width="989" height="569" alt="image" src="https://github.com/user-attachments/assets/ea98ce5e-d8a3-415b-8ea2-38eaea28c3bb" />

(Phase 2  - Near Balanced)

<img width="989" height="569" alt="image" src="https://github.com/user-attachments/assets/3c8f0c5b-b20b-4b9e-ae4d-b728b4502dcb" />


üìù Citation
If you use this code or methodology in your research, please cite:

Banha, P. (2025). Time-series GAN for Longitudinal Tabular Data: Validating Synthetic Data Utility in Multi-Class Health Prediction. [IPT Instituto Polit√©cnico de Tomar].

üìÅ Repository Structure

Data Preparation and Preprocessing (utilizes libraries available in PY_LIBRARIES):

\VS_Code\Dataset_VirtualPatientModels_qDateVS_Final.ipynb

\VS_Code\Dataset_VirtualPatientModels_qDateVS_Final_fix.ipynb ( The fix version set the numerical features to specific features)


Generation of synthetic data (Phase 1 - Imbalanced) and data quality checks: 

\VS_Code\Synthetic_timeGAN_Imbalanced_Final_Dis.ipynb

Generation of synthetic data (Phase 2  - Near Balanced) and data quality checks:

\VS_Code\Synthetic_timeGAN_Balanced_Final_Dis.ipynb

M1 MLP Model evaluation on real data (117 records split 70% training 30 % test) 

\VS_Code\MulticlassModel_RealData_Balanced_MLP_Final_Dis.ipynb

M2 MLP Model evaluation "Train Synthetic, Test Real"  (Phase 1 - Imbalanced)

\VS_Code\MulticlassModel_SynthData_ImBal_MLP_Final_Dis.ipynb

M3 MLP Model evaluation "Train Synthetic, Test Real"  (Phase 2  - Near Balanced)

\VS_Code\MulticlassModel_SynthData_Balanced_MLP_Final_Dis.ipynb

M4 LTSM Model evaluation "Train Synthetic, Test Real"  (Phase 2  - Near Balanced)

\VS_Code\MulticlassModel_SynthData_Bal_LSTM_newparams_Dis.ipynb

All csv files were generated by the code in these notebooks and they are needed for each fase of the entire process

üõ†Ô∏è Setup & Installation
To ensure full reproducibility of the experiments and avoid library version conflicts, it is highly recommended to use a Python Virtual Environment.

1. Clone the Repository
Bash

git clone https://github.com/paulobanha-web/VSCODE.git
cd VSCODE
2. Create and Activate a Virtual Environment
Using a virtual environment ensures that the specific versions of TensorFlow, NumPy, and Scikit-Learn used in this dissertation do not interfere with your global Python setup.

On Windows:

Bash

python -m venv venv
venv\Scripts\activate
On macOS / Linux:

Bash

python3 -m venv venv
source venv/bin/activate
3. Install Dependencies
Once the environment is active, install the exact versions of the libraries used in this research:

Bash

pip install --upgrade pip
pip install -r requirements.txt
[!TIP] Why use a Virtual Environment? > Longitudinal health prediction models are sensitive to library versions (especially TensorFlow and NumPy). Using the requirements.txt within a clean venv ensures that the TimeGAN training and LSTM evaluation behave exactly as documented in the dissertation.

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
